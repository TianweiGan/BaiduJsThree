/* eslint-disable */
function load(t,{onLoad:e,onProgress:n,onError:r,responseType:i,withCredentials:o,mimeType:s,requestHeader:a}){request=new XMLHttpRequest,request.open("GET",t,!0),request.addEventListener("load",function(t){const n=this.response;200===this.status||0===this.status?(0===this.status&&console.warn("HTTP Status 0 received."),e&&e(n)):r&&r(t)},!1),request.addEventListener("progress",function(t){n&&n(t)},!1),request.addEventListener("error",function(t){r&&r(t)},!1),request.addEventListener("abort",function(t){r&&r(t)},!1),void 0!==i&&(request.responseType=i),void 0!==o&&(request.withCredentials=o),request.overrideMimeType&&request.overrideMimeType(void 0!==s?s:"text/plain");for(const t in a)request.setRequestHeader(t,a[t]);return request.send(null),request}var keys,values,lengths,dim,e;!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Pbf=t()}}(function(){return function(){return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){return i(e[s][1][t]||t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}}()({1:[function(t,e,n){"use strict";e.exports=i;var r=t("ieee754");function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function s(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function l(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function c(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function v(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=x(this.buf,this.pos)+4294967296*x(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=x(this.buf,this.pos)+4294967296*b(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(i=o[n.pos++],r=(112&i)>>4,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<3,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<10,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<17,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<24,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(1&i)<<31,i<128)return a(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&o?function(t,e,n){return o.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){var r="",i=e;for(;i<n;){var o,s,a,u=t[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h>n)break;1===h?u<128&&(l=u):2===h?128==(192&(o=t[i+1]))&&(l=(31&u)<<6|63&o)<=127&&(l=null):3===h?(o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&((l=(15&u)<<12|(63&o)<<6|63&s)<=2047||l>=55296&&l<=57343)&&(l=null)):4===h&&(o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,h=1):l>65535&&(l-=65536,r+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),r+=String.fromCharCode(l),i+=h}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var n=s(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&u(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&u(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,l,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,m,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},{ieee754:2}],2:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,l=u>>1,h=-7,c=n?i-1:0,f=n?-1:1,d=t[e+c];for(c+=f,o=d&(1<<-h)-1,d>>=-h,h+=a;h>0;o=256*o+t[e+c],c+=f,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+c],c+=f,h-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=l}return(d?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,l=8*o-i-1,h=(1<<l)-1,c=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(s++,u/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(e*u-1)*Math.pow(2,i),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[n+d]=255&s,d+=p,s/=256,l-=8);t[n+d-p]|=128*y}},{}]},{},[1])(1)});var geometryTypes=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"];function decode(t){dim=2,e=Math.pow(10,2),lengths=null,keys=[],values=[];var n=t.readFields(readDataField,{});return keys=null,n}function readDataField(t,n,r){1===t?keys.push(r.readString()):2===t?dim=r.readVarint():3===t?e=Math.pow(10,r.readVarint()):4===t?readFeatureCollection(r,n):5===t?readFeature(r,n):6===t&&readGeometry(r,n)}function readFeatureCollection(t,e){return e.type="FeatureCollection",e.features=[],t.readMessage(readFeatureCollectionField,e)}function readFeature(t,e){e.type="Feature";var n=t.readMessage(readFeatureField,e);return"geometry"in n||(n.geometry=null),n}function readGeometry(t,e){return e.type="Point",t.readMessage(readGeometryField,e)}function readFeatureCollectionField(t,e,n){1===t?e.features.push(readFeature(n,{})):13===t?values.push(readValue(n)):15===t&&readProps(n,e)}function readFeatureField(t,e,n){1===t?e.geometry=readGeometry(n,{}):11===t?e.id=n.readString():12===t?e.id=n.readSVarint():13===t?values.push(readValue(n)):14===t?e.properties=readProps(n,{}):15===t&&readProps(n,e)}function readGeometryField(t,e,n){1===t?e.type=geometryTypes[n.readVarint()]:2===t?lengths=n.readPackedVarint():3===t?readCoords(e,n,e.type):4===t?(e.geometries=e.geometries||[],e.geometries.push(readGeometry(n,{}))):13===t?values.push(readValue(n)):15===t&&readProps(n,e)}function readCoords(t,e,n){"Point"===n?t.coordinates=readPoint(e):"MultiPoint"===n?t.coordinates=readLine(e,!0):"LineString"===n?t.coordinates=readLine(e):"MultiLineString"===n?t.coordinates=readMultiLine(e):"Polygon"===n?t.coordinates=readMultiLine(e,!0):"MultiPolygon"===n&&(t.coordinates=readMultiPolygon(e))}function readValue(t){for(var e=t.readVarint()+t.pos,n=null;t.pos<e;){var r=t.readVarint()>>3;1===r?n=t.readString():2===r?n=t.readDouble():3===r?n=t.readVarint():4===r?n=-t.readVarint():5===r?n=t.readBoolean():6===r&&(n=JSON.parse(t.readString()))}return n}function readProps(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;)e[keys[t.readVarint()]]=values[t.readVarint()];return values=[],e}function readPoint(t){for(var n=t.readVarint()+t.pos,r=[];t.pos<n;)r.push(t.readSVarint()/e);return r}function readLinePart(t,n,r,i){var o,s,a=0,u=[],l=[];for(s=0;s<dim;s++)l[s]=0;for(;r?a<r:t.pos<n;){for(o=[],s=0;s<dim;s++)l[s]+=t.readSVarint(),o[s]=l[s]/e;u.push(o),a++}return i&&u.push(u[0]),u}function readLine(t){return readLinePart(t,t.readVarint()+t.pos)}function readMultiLine(t,e){var n=t.readVarint()+t.pos;if(!lengths)return[readLinePart(t,n,null,e)];for(var r=[],i=0;i<lengths.length;i++)r.push(readLinePart(t,n,lengths[i],e));return lengths=null,r}function readMultiPolygon(t){var e=t.readVarint()+t.pos;if(!lengths)return[[readLinePart(t,e,null,!0)]];for(var n=[],r=1,i=0;i<lengths[0];i++){for(var o=[],s=0;s<lengths[r];s++)o.push(readLinePart(t,e,lengths[r+1+s],!0));r+=lengths[r]+1,n.push(o)}return lengths=null,n}function dot(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function v2Dot(t,e){return t[0]*e[0]+t[1]*e[1]}function normalize(t,e){const n=e[0],r=e[1],i=e[2],o=Math.sqrt(n*n+r*r+i*i);return t[0]=n/o,t[1]=r/o,t[2]=i/o,t}function v2Normalize(t,e){const n=e[0],r=e[1],i=Math.sqrt(n*n+r*r);return t[0]=n/i,t[1]=r/i,t}function scale(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function mul(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function scaleAndAdd(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function add(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function v2Add(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function sub(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function v2Sub(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function v3Sub(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function v3Normalize(t,e){const n=e[0],r=e[1],i=e[2],o=Math.sqrt(n*n+r*r+i*i);return t[0]=n/o,t[1]=r/o,t[2]=i/o,t}function v3Cross(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t}!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).earcut=t()}(function(){return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){return i(e[s][1][t]||t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,a,u,l,h,d,y,g=e&&e.length,m=g?e[0]*n:t.length,x=i(t,0,m,n,!0),v=[];if(!x)return v;if(g&&(x=function(t,e,n,r){var s,a,u,l=[];for(s=0,a=e.length;s<a;s++)(u=i(t,e[s]*r,s<a-1?e[s+1]*r:t.length,r,!1))===u.next&&(u.steiner=!0),l.push(p(u));for(l.sort(c),s=0;s<l.length;s++)f(l[s],n),n=o(n,n.next);return n}(t,e,x,n)),t.length>80*n){r=u=t[0],a=l=t[1];for(var b=n;b<m;b+=n)(h=t[b])<r&&(r=h),(d=t[b+1])<a&&(a=d),h>u&&(u=h),d>l&&(l=d);y=0!==(y=Math.max(u-r,l-a))?1/y:0}return s(x,v,n,r,a,y),v}function i(t,e,n,r,i){var o,s;if(i===S(t,e,n,r)>0)for(o=e;o<n;o+=r)s=w(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=w(o,t[o],t[o+1],s);return s&&m(s,s.next)&&(M(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(M(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function s(t,e,n,r,i,c,f){if(t){!f&&c&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,u,l=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<l&&(a++,r=r.nextZ);e++);for(u=l;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(s>1)}(i)}(t,r,i,c);for(var p,y,g=t;t.prev!==t.next;)if(p=t.prev,y=t.next,c?u(t,r,i,c):a(t))e.push(p.i/n),e.push(t.i/n),e.push(y.i/n),M(t),t=y.next,g=y.next;else if((t=y)===g){f?1===f?s(t=l(t,e,n),e,n,r,i,c,2):2===f&&h(t,e,n,r,i,c):s(o(t),e,n,r,i,c,1);break}}}function a(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(y(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,s=t.next;if(g(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,l=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,h=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,c=d(a,u,e,n,r),f=d(l,h,e,n,r),p=t.prevZ,m=t.nextZ;p&&p.z>=c&&m&&m.z<=f;){if(p!==t.prev&&p!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,m!==t.prev&&m!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=f;){if(m!==t.prev&&m!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function l(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!m(i,o)&&x(i,r,r.next,o)&&v(i,o)&&v(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),M(r),M(r.next),r=t=o),r=r.next}while(r!==t);return r}function h(t,e,n,r,i,a){var u,l,h=t;do{for(var c=h.next.next;c!==h.prev;){if(h.i!==c.i&&(l=c,(u=h).next.i!==l.i&&u.prev.i!==l.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&x(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(u,l)&&v(u,l)&&v(l,u)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(u,l))){var f=b(h,c);return h=o(h,h.next),f=o(f,f.next),s(h,e,n,r,i,a),void s(f,e,n,r,i,a)}c=c.next}h=h.next}while(h!==t)}function c(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n.prev;var u,l=n,h=n.x,c=n.y,f=1/0;for(r=n.next;r!==l;)i>=r.x&&r.x>=h&&i!==r.x&&y(o<c?i:s,o,h,c,o<c?s:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<f||u===f&&r.x>n.x)&&v(r,t)&&(n=r,f=u),r=r.next;return n}(t,e)){var n=b(e,t);o(n,n.next)}}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,n,r){return!!(m(t,e)&&m(n,r)||m(t,r)&&m(n,e))||g(t,e,n)>0!=g(t,e,r)>0&&g(n,r,t)>0!=g(n,r,e)>0}function v(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var n=new z(t.i,t.x,t.y),r=new z(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){var i=new z(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function z(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}e.exports=r,e.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(S(t,0,o,n));if(i)for(var a=0,u=e.length;a<u;a++){var l=e[a]*n,h=a<u-1?e[a+1]*n:t.length;s-=Math.abs(S(t,l,h,n))}var c=0;for(a=0;a<r.length;a+=3){var f=r[a]*n,d=r[a+1]*n,p=r[a+2]*n;c+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},{}]},{},[1])(1)});const rel=[];function slerp(t,e,n,r){const i=dot(e,n),o=Math.acos(i)*r;return scaleAndAdd(rel,n,e,-i),normalize(rel,rel),scale(t,e,Math.cos(o)),scaleAndAdd(t,t,rel,Math.sin(o)),t}function lineIntersection(t,e,n,r,i,o,s,a,u,l){const h=s-i,c=a-o,f=(h*(e-o)-c*(t-i))/(c*(n-t)-h*(r-e));return u[l]=t+f*(n-t),u[l+1]=e+f*(r-e),f}function area(t,e,n){if(n-e<3)return 0;let r=0;for(let i=2*(n-1),o=2*e;o<2*n;){const e=t[i],n=t[i+1],s=t[o],a=t[o+1];i=o,o+=2,r+=e*a-s*n}return r}function triangleArea(t,e,n,r,i,o){return(n-t)*(o-r)-(r-e)*(i-n)}function getSqDist(t,e){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function getSqSegDist(t,e,n){var r=e[0],i=e[1],o=n[0]-r,s=n[1]-i;if(0!==o||0!==s){var a=((t[0]-r)*o+(t[1]-i)*s)/(o*o+s*s);a>1?(r=n[0],i=n[1]):a>0&&(r+=o*a,i+=s*a)}return(o=t[0]-r)*o+(s=t[1]-i)*s}function simplifyRadialDist(t,e){for(var n,r=t[0],i=[r],o=1,s=t.length;o<s;o++)getSqDist(n=t[o],r)>e&&(i.push(n),r=n);return r!==n&&i.push(n),i}function simplifyDPStep(t,e,n,r,i){for(var o,s=r,a=e+1;a<n;a++){var u=getSqSegDist(t[a],t[e],t[n]);u>s&&(o=a,s=u)}s>r&&(o-e>1&&simplifyDPStep(t,e,o,r,i),i.push(t[o]),n-o>1&&simplifyDPStep(t,o,n,r,i))}function simplifyDouglasPeucker(t,e){var n=t.length-1,r=[t[0]];return simplifyDPStep(t,0,n,e,r),r.push(t[n]),r}function simplify(t,e,n){if(t.length<=2)return t;var r=void 0!==e?e*e:1;return t=simplifyDouglasPeucker(t=n?t:simplifyRadialDist(t,r),r)}function triangulate(t,e,n=2){return earcut(t,e,n)}function flatten(t){return earcut.flatten(t)}const v1=[],v2=[],v=[];function innerOffsetPolygon(t,e,n,r,i,o,s,a){const u=null!=s;let l=i,h=null;u&&(h=new Uint32Array(r-n));for(let i=n;i<r;i++){const c=i===r-1?n:i+1,f=i===n?r-1:i-1,d=t[2*f],p=t[2*f+1],y=t[2*i],g=t[2*i+1],m=t[2*c],x=t[2*c+1];if(v1[0]=y-d,v1[1]=g-p,v2[0]=m-y,v2[1]=x-g,v2Normalize(v1,v1),v2Normalize(v2,v2),u&&(h[i]=l),a||i!==n)if(a||i!==r-1){v2Add(v,v2,v1);const t=v[1];v[1]=-v[0],v[0]=t,v2Normalize(v,v);const n=v2Dot(v,v2),r=Math.sqrt(1-n*n),i=o*Math.min(10,1/r),a=o*n<0;if(u&&1/r>s&&a){const t=y+v[0]*o,n=g+v[1]*o,i=Math.acos(r)/2,s=Math.tan(i)*Math.abs(o);e[2*l]=t+v[1]*s,e[2*l+1]=n-v[0]*s,e[2*++l]=t-v[1]*s,e[2*l+1]=n+v[0]*s,l++}else e[2*l]=y+v[0]*i,e[2*l+1]=g+v[1]*i,l++}else v[0]=v1[1],v[1]=-v1[0],v2Normalize(v,v),e[2*l]=y+v[0]*o,e[2*l+1]=g+v[1]*o,l++;else v[0]=v2[1],v[1]=-v2[0],v2Normalize(v,v),e[2*l]=y+v[0]*o,e[2*l+1]=g+v[1]*o,l++}return h}function offsetPolygon(t,e,n,r,i){const o=null!=r?[]:new Float32Array(t.length);if(innerOffsetPolygon(t,o,0,e&&e.length?e[0]:t.length/2,0,n,r,i,!1),e)for(let s=0;s<e.length;s++){const a=e[s];innerOffsetPolygon(t,o,a,e[s+1]||t.length/2,null!=r?o.length/2:a,n,r,i)}return o}function reversePoints(t,e,n,r){for(let i=0;i<Math.floor((r-n)/2);i++)for(let o=0;o<e;o++){const s=(i+n)*e+o,a=(r-i-1)*e+o,u=t[s];t[s]=t[a],t[a]=u}return t}function convertToClockwise(t,e){let n=t.length/2,r=0,i=e&&e.length?e[0]:n;area(t,r,i)>0&&reversePoints(t,2,r,i);for(let o=1;o<(e?e.length:0)+1;o++)area(t,r=e[o-1],i=e[o]||n)<0&&reversePoints(t,2,r,i)}function normalizeOpts(t){t.depth=t.depth||1,t.bevelSize=t.bevelSize||0,t.bevelSegments=null==t.bevelSegments?2:t.bevelSegments,t.smoothSide=t.smoothSide||!1,t.smoothBevel=t.smoothBevel||!1,t.simplify=t.simplify||0,"number"==typeof t.depth&&(t.bevelSize=Math.min(t.bevelSegments>0?t.bevelSize:0,t.depth/2)),t.bevelSize>0||(t.bevelSegments=0),t.bevelSegments=Math.round(t.bevelSegments);const e=t.boundingRect;if(t.translate=t.translate||[0,0],t.scale=t.scale||[1,1],t.fitRect){let n=null==t.fitRect.x?e.x||0:t.fitRect.x,r=null==t.fitRect.y?e.y||0:t.fitRect.y,i=t.fitRect.width,o=t.fitRect.height;null==i?null!=o?i=o/e.height*e.width:(i=e.width,o=e.height):null==o&&(o=i/e.width*e.height),t.scale=[i/e.width,o/e.height],t.translate=[(n-e.x)*t.scale[0],(r-e.y)*t.scale[1]]}}function generateNormal(t,e){function n(t,e,n,r){t[0]=e,t[1]=n,t[2]=r}const r=[],i=[],o=[],s=[],a=[],u=[],l=t.length,h=new Float32Array(e.length);for(let c=0;c<l;){const l=3*t[c++],f=3*t[c++],d=3*t[c++];n(r,e[l],e[l+1],e[l+2]),n(i,e[f],e[f+1],e[f+2]),n(o,e[d],e[d+1],e[d+2]),v3Sub(s,r,i),v3Sub(a,i,o),v3Cross(u,s,a);for(let t=0;t<3;t++)h[l+t]=h[l+t]+u[t],h[f+t]=h[f+t]+u[t],h[d+t]=h[d+t]+u[t]}for(var c=0;c<h.length;)n(u,h[c],h[c+1],h[c+2]),v3Normalize(u,u),h[c++]=u[0],h[c++]=u[1],h[c++]=u[2];return h}const quadToTriangle=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function addExtrudeSide(t,{vertices:e,topVertices:n,depth:r,rect:i},o,s,a,u){const l=s-o,h=u.smoothSide?1:2,c=l*h,f=u.smoothBevel?1:2,d=Math.min(r/2,u.bevelSize),p=u.bevelSegments,y=a.vertex,g=2*(i.width+i.height);if(d>0){const i=[0,0,1],s=[],u=[0,0,-1],m=[];let x=0,v=new Float32Array(l);for(let b=0;b<2;b++){const w=0===b?r-d:d;for(let r=0;r<=p*f;r++){let M,z,S=0;for(let A=0;A<l;A++){for(let y=0;y<h;y++){let h=2*((A+y)%l+o);s[0]=e[h]-n[h],s[1]=e[h+1]-n[h+1],s[2]=0;const x=Math.sqrt(s[0]*s[0]+s[1]*s[1]);s[0]/=x,s[1]/=x;const B=(Math.floor(r/f)+r%f)/p;0===b?slerp(m,i,s,B):slerp(m,s,u,B);const P=0===b?B:1-B,k=d*Math.sin(P*Math.PI/2),N=x*Math.cos(P*Math.PI/2),T=d*x/Math.sqrt(k*k+N*N),_=m[0]*T+n[h],R=m[1]*T+n[h+1],F=m[2]*T+w;if(t.position[3*a.vertex]=_,t.position[3*a.vertex+1]=R,t.position[3*a.vertex+2]=F,(A>0||y>0)&&(S+=Math.sqrt((M-_)*(M-_)+(z-R)*(z-R))),r>0||b>0){let e=3*(a.vertex-c),n=t.position[e],r=t.position[e+1],i=t.position[e+2];v[A]+=Math.sqrt((n-_)*(n-_)+(r-R)*(r-R)+(i-F)*(i-F))}t.uv[2*a.vertex]=S/g,t.uv[2*a.vertex+1]=v[A]/(g+T),M=_,z=R,a.vertex++}if(f>1&&r%f||1===f&&r>=1)for(let e=0;e<6;e++){const n=(quadToTriangle[e][0]+A*h)%c,r=quadToTriangle[e][1]+x;t.indices[a.index++]=(r-1)*c+n+y}}x++}}}else for(let n=0;n<2;n++){const i=0===n?r-d:d;let s,u,c=0;for(let n=0;n<l;n++)for(let f=0;f<h;f++){const h=2*((n+f)%l+o),d=e[h],p=e[h+1];t.position[3*a.vertex]=d,t.position[3*a.vertex+1]=p,t.position[3*a.vertex+2]=i,(n>0||f>0)&&(c+=Math.sqrt((s-d)*(s-d)+(u-p)*(u-p))),t.uv[2*a.vertex]=c/g,t.uv[2*a.vertex+1]=i/r,s=d,u=p,a.vertex++}}const m=d>0?p*f+1:1;for(let e=0;e<l;e++)for(let n=0;n<6;n++){const r=(quadToTriangle[n][0]+e*h)%c,i=quadToTriangle[n][1]+m;t.indices[a.index++]=(i-1)*c+r+y}}function addTopAndBottom({indices:t,vertices:e,topVertices:n,rect:r,depth:i},o,s,a){if(e.length<=4)return;const u=s.vertex,l=t.length;for(let e=0;e<l;e++)o.indices[s.index++]=u+t[e];for(let t=0;t<(a.excludeBottom?1:2);t++)for(let e=0;e<n.length;e+=2){const a=n[e],u=n[e+1];o.position[3*s.vertex]=a,o.position[3*s.vertex+1]=u,o.position[3*s.vertex+2]=(1-t)*i,o.uv[2*s.vertex]=(a-r.x)/r.width,o.uv[2*s.vertex+1]=(u-r.y)/r.height,s.vertex++}if(!a.excludeBottom){const n=e.length/2;for(let e=0;e<l;e+=3)for(let r=0;r<3;r++)o.indices[s.index++]=u+n+t[e+2-r]}}function innerExtrudeTriangulatedPolygon(t,e){let n=0,r=0;for(let i=0;i<t.length;i++){const{indices:o,vertices:s,holes:a,depth:u}=t[i],l=s.length/2,h=Math.min(u/2,e.bevelSize)>0?e.bevelSegments:0;n+=o.length*(e.excludeBottom?1:2),r+=l*(e.excludeBottom?1:2);const c=2+2*h;let f=0,d=0;for(let t=0;t<(a?a.length:0)+1;t++){0===t?d=a&&a.length?a[0]:l:(f=a[t-1],d=a[t]||l),n+=6*(d-f)*(c-1);const i=(d-f)*(e.smoothSide?1:2);r+=i*c+(e.smoothBevel?0:h*i*2)}}const i={position:new Float32Array(3*r),indices:new(r>65535?Uint32Array:Uint16Array)(n),uv:new Float32Array(2*r)},o={vertex:0,index:0};for(let n=0;n<t.length;n++)addTopAndBottom(t[n],i,o,e);for(let n=0;n<t.length;n++){const{holes:r,vertices:s}=t[n],a=s.length/2;let u=0,l=r&&r.length?r[0]:a;if(addExtrudeSide(i,t[n],u,l,o,e),r)for(let s=0;s<r.length;s++)u=r[s],l=r[s+1]||a,addExtrudeSide(i,t[n],u,l,o,e)}for(let t=0;t<i.uv.length;t++){const e=i.uv[t];e>0&&Math.round(e)===e?i.uv[t]=1:i.uv[t]=e%1}return i.normal=generateNormal(i.indices,i.position),i.boundingRect=t[0]&&t[0].rect,i}function convertPolylineToTriangulatedPolygon(t,e,n){const r=n.lineWidth,i=t.length,o=new Float32Array(2*i),s=n.translate||[0,0],a=n.scale||[1,1];for(let e=0,n=0;e<i;e++)o[n++]=t[e][0]*a[0]+s[0],o[n++]=t[e][1]*a[1]+s[1];area(o,0,i)<0&&reversePoints(o,2,0,i);const u=[],l=[],h=n.miterLimit,c=innerOffsetPolygon(o,l,0,i,0,-r/2,h,!1);reversePoints(o,2,0,i);const f=innerOffsetPolygon(o,u,0,i,0,-r/2,h,!1),d=(u.length+l.length)/2,p=new Float32Array(2*d);let y=0;const g=l.length/2;for(let t=0;t<l.length;t++)p[y++]=l[t];for(let t=0;t<u.length;t++)p[y++]=u[t];const m=new(d>65535?Uint32Array:Uint16Array)(3*(2*(i-1)+(d-2*i)));let x=0;for(let t=0;t<i-1;t++){const e=t+1;m[x++]=g-1-c[t],m[x++]=g-1-c[t]-1,m[x++]=f[t]+1+g,m[x++]=g-1-c[t],m[x++]=f[t]+1+g,m[x++]=f[t]+g,f[e]-f[t]==2?(m[x++]=f[t]+2+g,m[x++]=f[t]+1+g,m[x++]=g-c[e]-1):c[e]-c[t]==2&&(m[x++]=f[e]+g,m[x++]=g-1-(c[t]+1),m[x++]=g-1-(c[t]+2))}const v=n.bevelSize>0?offsetPolygon(p,[],n.bevelSize,null,!0):p,b=n.boundingRect;return{vertices:p,indices:m,topVertices:v,rect:{x:b.x*a[0]+s[0],y:b.y*a[1]+s[1],width:b.width*a[0],height:b.height*a[1]},depth:"function"==typeof n.depth?n.depth(e):n.depth,holes:[]}}function removeClosePointsOfPolygon(t,e){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=[],s=i.length;let a=i[s-1][0],u=i[s-1][1],l=0;for(let t=0;t<s;t++){let n=i[t][0],r=i[t][1];const s=n-a,h=r-u;(l+=Math.sqrt(s*s+h*h))>e&&(o.push(i[t]),l=0),a=n,u=r}o.length>=3&&n.push(o)}return n.length>0?n:null}function simplifyPolygon(t,e){const n=[];for(let r=0;r<t.length;r++){let i=t[r];(i=doSimplify(i,e,!0)).length>=3&&n.push(i)}return n.length>0?n:null}function extrudePolygon(t,e){e=Object.assign({},e);const n=[1/0,1/0],r=[-1/0,-1/0];for(let e=0;e<t.length;e++)updateBoundingRect(t[e][0],n,r);e.boundingRect=e.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},normalizeOpts(e);const i=[],o=e.translate||[0,0],s=e.scale||[1,1],a=e.boundingRect,u={x:a.x*s[0]+o[0],y:a.y*s[1]+o[1],width:a.width*s[0],height:a.height*s[1]},l=Math.min(a.width,a.height)/1e5;for(let n=0;n<t.length;n++){let r=removeClosePointsOfPolygon(t[n],l);if(!r)continue;const a=e.simplify/Math.max(s[0],s[1]);if(a>0&&(r=simplifyPolygon(r,a)),!r)continue;const{vertices:h,holes:c,dimensions:f}=earcut.flatten(r);for(let t=0;t<h.length;)h[t]=h[t++]*s[0]+o[0],h[t]=h[t++]*s[1]+o[1];if(convertToClockwise(h,c),2!==f)throw new Error("Only 2D polygon points are supported");const d=e.bevelSize>0?offsetPolygon(h,c,e.bevelSize,null,!0):h,p=triangulate(d,c,f);i.push({indices:p,vertices:h,topVertices:d,holes:c,rect:u,depth:"function"==typeof e.depth?e.depth(n):e.depth})}return innerExtrudeTriangulatedPolygon(i,e)}function extrudePolyline(t,e){e=Object.assign({},e);const n=[1/0,1/0],r=[-1/0,-1/0];for(let e=0;e<t.length;e++)updateBoundingRect(t[e],n,r);e.boundingRect=e.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},normalizeOpts(e);const i=e.scale||[1,1];null==e.lineWidth&&(e.lineWidth=1),null==e.miterLimit&&(e.miterLimit=2);const o=[];for(let n=0;n<t.length;n++){let r=t[n];const s=e.simplify/Math.max(i[0],i[1]);s>0&&(r=doSimplify(r,s,!0)),o.push(convertPolylineToTriangulatedPolygon(r,n,e))}return innerExtrudeTriangulatedPolygon(o,e)}function updateBoundingRect(t,e,n){for(let r=0;r<t.length;r++)e[0]=Math.min(t[r][0],e[0]),e[1]=Math.min(t[r][1],e[1]),n[0]=Math.max(t[r][0],n[0]),n[1]=Math.max(t[r][1],n[1])}function extrudeGeoJSON(t,e){e=Object.assign({},e);const n=[],r=[],i=[],o=[],s=[1/0,1/0],a=[-1/0,-1/0];for(let e=0;e<t.features.length;e++){const u=t.features[e].geometry;if(u&&u.coordinates)switch(u.type){case"LineString":n.push(u.coordinates),i.push(e),updateBoundingRect(u.coordinates,s,a);break;case"MultiLineString":for(let t=0;t<u.coordinates.length;t++)n.push(u.coordinates[t]),i.push(e),updateBoundingRect(u.coordinates[t],s,a);break;case"Polygon":r.push(u.coordinates),o.push(e),updateBoundingRect(u.coordinates[0],s,a);break;case"MultiPolygon":for(let t=0;t<u.coordinates.length;t++)r.push(u.coordinates[t]),o.push(e),updateBoundingRect(u.coordinates[t][0],s,a)}}e.boundingRect=e.boundingRect||{x:s[0],y:s[1],width:a[0]-s[0],height:a[1]-s[1]};const u=e.depth;return{polyline:extrudePolyline(n,Object.assign(e,{depth:function(e){return"function"==typeof u?u(t.features[i[e]]):u}})),polygon:extrudePolygon(r,Object.assign(e,{depth:function(e){return"function"==typeof u?u(t.features[o[e]]):u}}))}}const TYPES=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];function getGeoJSONType(t={}){return(t.geometry||{}).type}function isGeoJSON(t={}){const e=getGeoJSONType(t);if(e)for(let t=0,n=TYPES.length;t<n;t++)if(TYPES[t]===e)return!0;return!1}function isGeoJSONPolygon(t={}){const e=getGeoJSONType(t);return!(!e||e!==TYPES[4]&&e!==TYPES[5])}function isGeoJSONLine(t={}){const e=getGeoJSONType(t);return!(!e||e!==TYPES[2]&&e!==TYPES[3])}function isGeoJSONPoint(t={}){const e=getGeoJSONType(t);return!(!e||e!==TYPES[0]&&e!==TYPES[1])}function isGeoJSONMulti(t={}){const e=getGeoJSONType(t);return!!(e&&e.indexOf("Multi")>-1)}function getGeoJSONCoordinates(t={}){return(t.geometry||{}).coordinates||[]}function getGeoJSONCenter(t={}){const e=getGeoJSONType(t);if(!e)return null;const n=(t.geometry||{}).coordinates;if(!n)return null;const r=[];switch(e){case"Point":r.push(n);break;case"MultiPoint":case"LineString":for(let t=0,e=n.length;t<e;t++)r.push(n[t]);break;case"MultiLineString":case"Polygon":for(let t=0,e=n.length;t<e;t++)for(let e=0,i=n[t].length;e<i;e++)r.push(n[t][e]);break;case"MultiPolygon":for(let t=0,e=n.length;t<e;t++)for(let e=0,i=n[t].length;e<i;e++)for(let i=0,o=n[t][e].length;i<o;i++)r.push(n[t][e][i])}let i=1/0,o=1/0,s=-1/0,a=-1/0;for(let t=0,e=r.length;t<e;t++){const e=r[t],n=e[0],u=e[1];i=Math.min(i,n),o=Math.min(o,u),s=Math.max(s,n),a=Math.max(a,u)}return[(i+s)/2,(o+a)/2]}function spliteGeoJSONMulti(t={}){const e=getGeoJSONType(t);if(!e)return null;const n=t.geometry||{},r=t.properties||{},i=n.coordinates;if(!i)return null;const o=[];let s;switch(e){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}if(s)for(let t=0,e=i.length;t<e;t++)o.push({type:"Feature",geometry:{type:s,coordinates:i[t]},properties:r});else o.push(t);return o}const Arrow={NO_TURN:[[-.07401716363582,.34],[.075982836364157,.34],[.075982836364157,-1.46],[-.07401716363582,-1.46],[-.07401716363582,.34],[-.224017163635797,.34],[.000982836364225,1.54],[.225982836364134,.34],[.075982836364157,.34],[-.07401716363582,.34]],RIGHT_TURN:[[-.075,-1.46],[-.075,.338],[.473,.871],[.469,1.401],[.682,.609],[.472,-.163],[.475,.287],[.066,-.11],[.075,-1.46],[-.075,-1.46]],LEFT_TURN:[[.074,-1.46],[-.076,-1.46],[-.07,-.11],[-.48,.286],[-.476,-.164],[-.688,.608],[-.476,1.4],[-.479,.87],[.074,.347],[.074,-1.46]],"LEFT_TURN,U_TURN":[[-.072,-.472],[-.087,-.457],[-.104,-.445],[-.123,-.434],[-.14,-.427],[-.158,-.423],[-.179,-.42],[-.198,-.42],[-.219,-.423],[-.237,-.428],[-.256,-.437],[-.274,-.448],[-.289,-.459],[-.3,-.47],[-.313,-.487],[-.324,-.506],[-.332,-.525],[-.337,-.547],[-.338,-.775],[-.223,-.775],[-.389,-1.459],[-.563,-.775],[-.452,-.775],[-.453,-.462],[-.451,-.432],[-.449,-.415],[-.44,-.382],[-.427,-.349],[-.409,-.319],[-.399,-.305],[-.375,-.279],[-.348,-.257],[-.334,-.247],[-.319,-.238],[-.287,-.224],[-.254,-.214],[-.219,-.209],[-.202,-.209],[-.167,-.211],[-.133,-.218],[-.116,-.223],[-.1,-.229],[-.071,-.244],[-.07,-.102],[-.47,.289],[-.469,-.161],[-.676,.612],[-.46,1.403],[-.466,.873],[.072,.347],[.073,-1.46],[-.075,-1.46],[-.072,-.472]],U_TURN:[[-.58,.539],[-.376,.539],[-.675,-.668],[-.976,.541],[-.78,.54],[-.78,1.083],[-.78,1.114],[-.775,1.161],[-.765,1.207],[-.756,1.237],[-.738,1.28],[-.712,1.328],[-.685,1.367],[-.649,1.408],[-.614,1.439],[-.589,1.458],[-.55,1.483],[-.493,1.509],[-.463,1.519],[-.433,1.527],[-.395,1.534],[-.364,1.538],[-.333,1.539],[-.286,1.536],[-.255,1.532],[-.224,1.525],[-.179,1.512],[-.15,1.5],[-.122,1.486],[-.089,1.467],[-.051,1.439],[-.027,1.419],[-.005,1.396],[.03,1.354],[.051,1.322],[.073,1.28],[.088,1.244],[.102,1.199],[.107,1.177],[.113,1.13],[.115,1.087],[.11,.581],[.11,-1.462],[-.111,-1.462],[-.109,.882],[-.116,.922],[-.123,.944],[-.134,.967],[-.152,.995],[-.167,1.014],[-.187,1.035],[-.206,1.05],[-.226,1.063],[-.263,1.08],[-.29,1.089],[-.306,1.092],[-.339,1.095],[-.379,1.092],[-.411,1.084],[-.426,1.079],[-.449,1.069],[-.47,1.057],[-.499,1.035],[-.516,1.017],[-.534,.995],[-.551,.967],[-.564,.936],[-.571,.909],[-.576,.875],[-.58,.539]],"LEFT_TURN,RIGHT_TURN":[[.076,.503],[.46,.891],[.466,1.391],[.663,.578],[.453,-.158],[.453,.292],[.194,.026],[.062,-.111],[.073,-1.46],[-.077,-1.46],[-.072,-.11],[-.482,.286],[-.478,-.164],[-.69,.607],[-.479,1.4],[-.482,.87],[-.011,.415],[.076,.503]],"NO_TURN,RIGHT_TURN":[[.225,.34],[.075,.34],[.075,-.659],[.468,-.255],[.471,.245],[.672,-.568],[.466,-1.304],[.464,-.854],[.075,-1.258],[.075,-1.46],[-.075,-1.46],[-.075,.34],[-.225,.34],[0,1.54],[.225,.34]],"RIGHT_TURN,NO_TURN":[[.225,.34],[.075,.34],[.075,-.659],[.468,-.255],[.471,.245],[.672,-.568],[.466,-1.304],[.464,-.854],[.075,-1.258],[.075,-1.46],[-.075,-1.46],[-.075,.34],[-.225,.34],[0,1.54],[.225,.34]],"NO_TURN,U_TURN":[[-.075,-.345],[-.09,-.33],[-.105,-.319],[-.123,-.308],[-.143,-.3],[-.161,-.296],[-.182,-.293],[-.203,-.293],[-.224,-.297],[-.242,-.302],[-.259,-.309],[-.277,-.32],[-.292,-.332],[-.305,-.345],[-.318,-.362],[-.328,-.381],[-.336,-.401],[-.34,-.419],[-.341,-.648],[-.226,-.648],[-.392,-1.332],[-.565,-.648],[-.455,-.648],[-.456,-.335],[-.454,-.305],[-.448,-.271],[-.437,-.238],[-.421,-.207],[-.412,-.192],[-.39,-.165],[-.378,-.152],[-.351,-.13],[-.322,-.111],[-.29,-.097],[-.256,-.087],[-.239,-.084],[-.204,-.081],[-.187,-.082],[-.152,-.086],[-.119,-.096],[-.103,-.102],[-.075,-.117],[-.075,.34],[-.225,.34],[0,1.54],[.225,.34],[.075,.34],[.075,-1.46],[-.075,-1.46],[-.075,-.345]],"NO_TURN,LEFT_TURN":[[.076,.296],[.075,-.72],[.074,-1.46],[-.076,-1.46],[-.076,-1.258],[-.464,-.853],[-.467,-1.303],[-.672,-.567],[-.47,.246],[-.467,-.254],[-.075,-.659],[-.075,-.622],[-.074,.291],[-.073,.34],[-.073,.34],[-.223,.34],[.003,1.54],[.227,.34],[.077,.34],[.076,.296]],"LEFT_TURN,NO_TURN":[[.076,.296],[.075,-.72],[.074,-1.46],[-.076,-1.46],[-.076,-1.258],[-.464,-.853],[-.467,-1.303],[-.672,-.567],[-.47,.246],[-.467,-.254],[-.075,-.659],[-.075,-.622],[-.074,.291],[-.073,.34],[-.073,.34],[-.223,.34],[.003,1.54],[.227,.34],[.077,.34],[.076,.296]],"NO_TURN,LEFT_TURN,RIGHT_TURN,U_TURN":[[-.12,-.09],[-.51,.29],[-.51,.25],[-.51,.22],[-.51,.02],[-.74,.41],[-.51,.79],[-.5,.52],[-.07,.09],[-.07,.34],[-.22,.34],[0,1.54],[.23,.34],[.08,.34],[.08,.09],[.46,.52],[.46,.52],[.46,.53],[.46,.56],[.46,.6],[.46,.79],[.69,.41],[.48,.02],[.47,.29],[.47,.32],[.08,-.14],[.08,-.29],[.08,-1.46],[-.07,-1.46],[-.07,-.34],[-.09,-.33],[-.1,-.32],[-.12,-.31],[-.14,-.3],[-.16,-.3],[-.18,-.29],[-.2,-.29],[-.22,-.3],[-.24,-.3],[-.26,-.31],[-.28,-.32],[-.29,-.33],[-.3,-.35],[-.32,-.36],[-.33,-.38],[-.34,-.4],[-.34,-.42],[-.34,-.65],[-.23,-.65],[-.39,-1.33],[-.56,-.65],[-.45,-.65],[-.46,-.33],[-.45,-.31],[-.45,-.27],[-.44,-.24],[-.42,-.21],[-.41,-.19],[-.39,-.16],[-.38,-.15],[-.35,-.13],[-.32,-.11],[-.29,-.1],[-.26,-.09],[-.24,-.08],[-.2,-.08],[-.19,-.08],[-.15,-.09],[-.12,-.09]],"LEFT_TURN,RIGHT_TURN,U_TURN":[[-.07,-.48],[-.08,-.46],[-.1,-.45],[-.12,-.44],[-.14,-.43],[-.15,-.43],[-.18,-.43],[-.2,-.43],[-.22,-.43],[-.24,-.43],[-.25,-.44],[-.27,-.45],[-.29,-.46],[-.3,-.48],[-.31,-.49],[-.32,-.51],[-.33,-.53],[-.33,-.55],[-.34,-.78],[-.22,-.78],[-.39,-1.46],[-.56,-.78],[-.45,-.78],[-.45,-.47],[-.45,-.44],[-.44,-.4],[-.43,-.37],[-.42,-.34],[-.41,-.32],[-.38,-.3],[-.37,-.28],[-.35,-.26],[-.32,-.24],[-.28,-.23],[-.25,-.22],[-.23,-.22],[-.2,-.21],[-.18,-.21],[-.15,-.22],[-.11,-.23],[-.1,-.23],[-.07,-.25],[-.07,-.11],[-.48,.29],[-.48,-.16],[-.69,.61],[-.48,1.4],[-.48,.87],[-.01,.42],[.08,.5],[.46,.89],[.47,1.39],[.67,.58],[.46,-.16],[.46,.29],[.2,.03],[.06,-.11],[.08,-1.46],[-.07,-1.46],[-.07,-.48]],"NO_TURN,LEFT_TURN,RIGHT_TURN":[[.08,-1.46],[-.07,-1.46],[-.07,-1.26],[-.07,-.66],[-.07,-.62],[-.07,-.56],[-.47,-.17],[-.47,-.62],[-.68,.15],[-.47,.94],[-.47,.41],[-.07,.02],[-.07,.29],[-.07,.34],[-.07,.34],[-.22,.34],[.01,1.54],[.23,.34],[.08,.34],[.08,.3],[.08,.04],[.08,.04],[.47,.43],[.47,.93],[.67,.12],[.46,-.62],[.46,-.17],[.2,-.43],[.08,-.56],[.08,-.72],[.08,-1.26],[.08,-1.46]],"NO_TURN,RIGHT_TURN,U_TURN":[[.08,-.37],[.46,.03],[.47,.53],[.67,-.28],[.47,-1.02],[.46,-.57],[.08,-.97],[.08,-1.46],[-.07,-1.46],[-.07,-.35],[-.09,-.34],[-.1,-.32],[-.12,-.31],[-.14,-.31],[-.16,-.3],[-.18,-.3],[-.2,-.3],[-.22,-.3],[-.24,-.31],[-.26,-.32],[-.28,-.33],[-.29,-.34],[-.3,-.35],[-.32,-.37],[-.33,-.39],[-.33,-.41],[-.34,-.43],[-.34,-.66],[-.22,-.66],[-.38,-1.34],[-.56,-.66],[-.45,-.66],[-.45,-.35],[-.45,-.32],[-.45,-.28],[-.44,-.25],[-.42,-.22],[-.41,-.2],[-.39,-.17],[-.38,-.16],[-.35,-.14],[-.32,-.12],[-.29,-.11],[-.26,-.1],[-.24,-.09],[-.21,-.09],[-.19,-.09],[-.15,-.09],[-.12,-.1],[-.1,-.11],[-.08,-.12],[-.07,.34],[-.22,.34],[-0,1.54],[.23,.34],[.08,.34],[.08,-.12],[.08,-.34],[.08,-.37]],"NO_TURN,LEFT_TURN,U_TURN":[[-.51,.52],[-.08,.09],[-.08,.34],[-.23,.34],[-0,1.54],[.22,.34],[.07,.34],[.07,-.06],[.07,-.29],[.07,-1.46],[-.08,-1.46],[-.08,-.34],[-.09,-.33],[-.11,-.32],[-.12,-.31],[-.14,-.3],[-.16,-.3],[-.18,-.29],[-.2,-.29],[-.23,-.3],[-.24,-.3],[-.26,-.31],[-.28,-.32],[-.29,-.33],[-.31,-.35],[-.32,-.36],[-.33,-.38],[-.34,-.4],[-.34,-.42],[-.34,-.65],[-.23,-.65],[-.39,-1.33],[-.57,-.65],[-.46,-.65],[-.46,-.33],[-.46,-.31],[-.45,-.27],[-.44,-.24],[-.42,-.21],[-.41,-.19],[-.39,-.16],[-.38,-.15],[-.35,-.13],[-.32,-.11],[-.29,-.1],[-.26,-.09],[-.24,-.08],[-.21,-.08],[-.19,-.08],[-.15,-.09],[-.13,-.09],[-.51,.29],[-.51,.25],[-.51,.22],[-.51,.02],[-.74,.41],[-.51,.79],[-.51,.52]]};for(var _lut=[],i=0;i<256;i++)_lut[i]=(i<16?"0":"")+i.toString(16);var MathUtils={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(_lut[255&t]+_lut[t>>8&255]+_lut[t>>16&255]+_lut[t>>24&255]+"-"+_lut[255&e]+_lut[e>>8&255]+"-"+_lut[e>>16&15|64]+_lut[e>>24&255]+"-"+_lut[63&n|128]+_lut[n>>8&255]+"-"+_lut[n>>16&255]+_lut[n>>24&255]+_lut[255&r]+_lut[r>>8&255]+_lut[r>>16&255]+_lut[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*MathUtils.DEG2RAD},radToDeg:function(t){return t*MathUtils.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var o=Math.cos,s=Math.sin,a=o(n/2),u=s(n/2),l=o((e+r)/2),h=s((e+r)/2),c=o((e-r)/2),f=s((e-r)/2),d=o((r-e)/2),p=s((r-e)/2);switch(i){case"XYX":t.set(a*h,u*c,u*f,a*l);break;case"YZY":t.set(u*f,a*h,u*c,a*l);break;case"ZXZ":t.set(u*c,u*f,a*h,a*l);break;case"XZX":t.set(a*h,u*p,u*d,a*l);break;case"YXY":t.set(u*d,a*h,u*p,a*l);break;case"ZYZ":t.set(u*p,u*d,a*h,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};function Vector3(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function Box3(t,e){this.min=void 0!==t?t:new Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new Vector3(-1/0,-1/0,-1/0)}Object.assign(Vector3.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,s=e.y,a=e.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}),Object.assign(Box3.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,u=t.length;a<u;a+=3){var l=t[a],h=t[a+1],c=t[a+2];l<e&&(e=l),h<n&&(n=h),c<r&&(r=c),l>i&&(i=l),h>o&&(o=h),c>s&&(s=c)}return this.min.set(e,n,r),this.max.set(i,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=_vector.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Vector3),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Vector3),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Vector3),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){const e=new Vector3;return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Vector3),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return _vector.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var _v1=new Vector3,_m1=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3;function Matrix4(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function arrayMin(t){if(0===t.length)return 1/0;let e=t[0];for(let n=1,r=t.length;n<r;++n)t[n]<e&&(e=t[n]);return e}function arrayMax(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}function rotationAndTranslateVector(t,e,n){const r=new Matrix4,i=Math.cos(n),o=Math.sin(n);e&&e.x?r.set(i,-o,0,e.x,o,i,0,e.y,0,0,1,e.z||.4,0,0,0,1):e&&e[0]&&r.set(i,-o,0,e[0],o,i,0,e[1],0,0,1,e[2]||.4,0,0,0,1);const s=[];return t&&t.length&&t.forEach(t=>{s.push(new Vector3(t[0],t[1],0).applyMatrix4(r).toArray())}),s}function pointToPolygon(t){for(let e=t.length-1;e>-1;e--){let n=null;const r=t[e].properties.turn,i=MathUtils.DEG2RAD*(360-t[e].properties.heading),o=Arrow[r];o?(n=rotationAndTranslateVector(o,t[e].geometry.coordinates,i),t[e].geometry.coordinates=[n],t[e].geometry.type="Polygon"):t.splice(e,1)}return t}Object.assign(Matrix4.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,s,a,u,l,h,c,f,d,p,y){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=u,g[6]=l,g[10]=h,g[14]=c,g[3]=f,g[7]=d,g[11]=p,g[15]=y,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Matrix4).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/_v1.setFromMatrixColumn(t,0).length(),i=1/_v1.setFromMatrixColumn(t,1).length(),o=1/_v1.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),u=Math.sin(r),l=Math.cos(i),h=Math.sin(i);if("XYZ"===t.order){var c=o*l,f=o*h,d=s*l,p=s*h;e[0]=a*l,e[4]=-a*h,e[8]=u,e[1]=f+d*u,e[5]=c-p*u,e[9]=-s*a,e[2]=p-c*u,e[6]=d+f*u,e[10]=o*a}else if("YXZ"===t.order){var y=a*l,g=a*h,m=u*l,x=u*h;e[0]=y+x*s,e[4]=m*s-g,e[8]=o*u,e[1]=o*h,e[5]=o*l,e[9]=-s,e[2]=g*s-m,e[6]=x+y*s,e[10]=o*a}else if("ZXY"===t.order){y=a*l,g=a*h,m=u*l,x=u*h;e[0]=y-x*s,e[4]=-o*h,e[8]=m+g*s,e[1]=g+m*s,e[5]=o*l,e[9]=x-y*s,e[2]=-o*u,e[6]=s,e[10]=o*a}else if("ZYX"===t.order){c=o*l,f=o*h,d=s*l,p=s*h;e[0]=a*l,e[4]=d*u-f,e[8]=c*u+p,e[1]=a*h,e[5]=p*u+c,e[9]=f*u-d,e[2]=-u,e[6]=s*a,e[10]=o*a}else if("YZX"===t.order){var v=o*a,b=o*u,w=s*a,M=s*u;e[0]=a*l,e[4]=M-v*h,e[8]=w*h+b,e[1]=h,e[5]=o*l,e[9]=-s*l,e[2]=-u*l,e[6]=b*h+w,e[10]=v-M*h}else if("XZY"===t.order){v=o*a,b=o*u,w=s*a,M=s*u;e[0]=a*l,e[4]=-h,e[8]=u*l,e[1]=v*h+M,e[5]=o*l,e[9]=b*h-w,e[2]=w*h-b,e[6]=s*l,e[10]=M*h+v}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(_zero,t,_one)},lookAt:function(t,e,n){var r=this.elements;return _z.subVectors(t,e),0===_z.lengthSq()&&(_z.z=1),_z.normalize(),_x.crossVectors(n,_z),0===_x.lengthSq()&&(1===Math.abs(n.z)?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(n,_z)),_x.normalize(),_y.crossVectors(_z,_x),r[0]=_x.x,r[4]=_y.x,r[8]=_z.x,r[1]=_x.y,r[5]=_y.y,r[9]=_z.y,r[2]=_x.z,r[6]=_y.z,r[10]=_z.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[4],a=n[8],u=n[12],l=n[1],h=n[5],c=n[9],f=n[13],d=n[2],p=n[6],y=n[10],g=n[14],m=n[3],x=n[7],v=n[11],b=n[15],w=r[0],M=r[4],z=r[8],S=r[12],A=r[1],B=r[5],P=r[9],k=r[13],N=r[2],T=r[6],_=r[10],R=r[14],F=r[3],V=r[7],E=r[11],O=r[15];return i[0]=o*w+s*A+a*N+u*F,i[4]=o*M+s*B+a*T+u*V,i[8]=o*z+s*P+a*_+u*E,i[12]=o*S+s*k+a*R+u*O,i[1]=l*w+h*A+c*N+f*F,i[5]=l*M+h*B+c*T+f*V,i[9]=l*z+h*P+c*_+f*E,i[13]=l*S+h*k+c*R+f*O,i[2]=d*w+p*A+y*N+g*F,i[6]=d*M+p*B+y*T+g*V,i[10]=d*z+p*P+y*_+g*E,i[14]=d*S+p*k+y*R+g*O,i[3]=m*w+x*A+v*N+b*F,i[7]=m*M+x*B+v*T+b*V,i[11]=m*z+x*P+v*_+b*E,i[15]=m*S+x*k+v*R+b*O,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],s=t[5],a=t[9],u=t[13],l=t[2],h=t[6],c=t[10],f=t[14];return t[3]*(+i*a*h-r*u*h-i*s*c+n*u*c+r*s*f-n*a*f)+t[7]*(+e*a*f-e*u*c+i*o*c-r*o*f+r*u*l-i*a*l)+t[11]*(+e*u*h-e*s*f-i*o*h+n*o*f+i*s*l-n*u*l)+t[15]*(-r*s*l-e*a*h+e*s*c+r*o*h-n*o*c+n*a*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],o=r[1],s=r[2],a=r[3],u=r[4],l=r[5],h=r[6],c=r[7],f=r[8],d=r[9],p=r[10],y=r[11],g=r[12],m=r[13],x=r[14],v=r[15],b=d*x*c-m*p*c+m*h*y-l*x*y-d*h*v+l*p*v,w=g*p*c-f*x*c-g*h*y+u*x*y+f*h*v-u*p*v,M=f*m*c-g*d*c+g*l*y-u*m*y-f*l*v+u*d*v,z=g*d*h-f*m*h-g*l*p+u*m*p+f*l*x-u*d*x,S=i*b+o*w+s*M+a*z;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var A=1/S;return n[0]=b*A,n[1]=(m*p*a-d*x*a-m*s*y+o*x*y+d*s*v-o*p*v)*A,n[2]=(l*x*a-m*h*a+m*s*c-o*x*c-l*s*v+o*h*v)*A,n[3]=(d*h*a-l*p*a-d*s*c+o*p*c+l*s*y-o*h*y)*A,n[4]=w*A,n[5]=(f*x*a-g*p*a+g*s*y-i*x*y-f*s*v+i*p*v)*A,n[6]=(g*h*a-u*x*a-g*s*c+i*x*c+u*s*v-i*h*v)*A,n[7]=(u*p*a-f*h*a+f*s*c-i*p*c-u*s*y+i*h*y)*A,n[8]=M*A,n[9]=(g*d*a-f*m*a-g*o*y+i*m*y+f*o*v-i*d*v)*A,n[10]=(u*m*a-g*l*a+g*o*c-i*m*c-u*o*v+i*l*v)*A,n[11]=(f*l*a-u*d*a-f*o*c+i*d*c+u*o*y-i*l*y)*A,n[12]=z*A,n[13]=(f*m*s-g*d*s+g*o*p-i*m*p-f*o*x+i*d*x)*A,n[14]=(g*l*s-u*m*s-g*o*h+i*m*h+u*o*x-i*l*x)*A,n[15]=(u*d*s-f*l*s+f*o*h-i*d*h-u*o*p+i*l*p)*A,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,s=t.y,a=t.z,u=i*o,l=i*s;return this.set(u*o+n,u*s-r*a,u*a+r*s,0,u*s+r*a,l*s+n,l*a-r*o,0,u*a-r*s,l*a+r*o,i*a*a+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,s=e._z,a=e._w,u=i+i,l=o+o,h=s+s,c=i*u,f=i*l,d=i*h,p=o*l,y=o*h,g=s*h,m=a*u,x=a*l,v=a*h,b=n.x,w=n.y,M=n.z;return r[0]=(1-(p+g))*b,r[1]=(f+v)*b,r[2]=(d-x)*b,r[3]=0,r[4]=(f-v)*w,r[5]=(1-(c+g))*w,r[6]=(y+m)*w,r[7]=0,r[8]=(d+x)*M,r[9]=(y-m)*M,r[10]=(1-(c+p))*M,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=_v1.set(r[0],r[1],r[2]).length(),o=_v1.set(r[4],r[5],r[6]).length(),s=_v1.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],_m1.copy(this);var a=1/i,u=1/o,l=1/s;return _m1.elements[0]*=a,_m1.elements[1]*=a,_m1.elements[2]*=a,_m1.elements[4]*=u,_m1.elements[5]*=u,_m1.elements[6]*=u,_m1.elements[8]*=l,_m1.elements[9]*=l,_m1.elements[10]*=l,e.setFromRotationMatrix(_m1),n.x=i,n.y=o,n.z=s,this},makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*i/(e-t),u=2*i/(n-r),l=(e+t)/(e-t),h=(n+r)/(n-r),c=-(o+i)/(o-i),f=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=l,s[12]=0,s[1]=0,s[5]=u,s[9]=h,s[13]=0,s[2]=0,s[6]=0,s[10]=c,s[14]=f,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var s=this.elements,a=1/(e-t),u=1/(n-r),l=1/(o-i),h=(e+t)*a,c=(n+r)*u,f=(o+i)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-h,s[1]=0,s[5]=2*u,s[9]=0,s[13]=-c,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-f,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var _vector=new Vector3;const StaticDrawUsage=35044;function BufferAttribute(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}function Int8BufferAttribute(t,e,n){BufferAttribute.call(this,new Int8Array(t),e,n)}function Uint8BufferAttribute(t,e,n){BufferAttribute.call(this,new Uint8Array(t),e,n)}function Uint8ClampedBufferAttribute(t,e,n){BufferAttribute.call(this,new Uint8ClampedArray(t),e,n)}function Int16BufferAttribute(t,e,n){BufferAttribute.call(this,new Int16Array(t),e,n)}function Uint16BufferAttribute(t,e,n){BufferAttribute.call(this,new Uint16Array(t),e,n)}function Int32BufferAttribute(t,e,n){BufferAttribute.call(this,new Int32Array(t),e,n)}function Uint32BufferAttribute(t,e,n){BufferAttribute.call(this,new Uint32Array(t),e,n)}function Float32BufferAttribute(t,e,n){BufferAttribute.call(this,new Float32Array(t),e,n)}function Float64BufferAttribute(t,e,n){BufferAttribute.call(this,new Float64Array(t),e,n)}Object.defineProperty(BufferAttribute.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(BufferAttribute.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Vector3),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)_vector.x=this.getX(e),_vector.y=this.getY(e),_vector.z=this.getZ(e),_vector.transformDirection(t),this.setXYZ(e,_vector.x,_vector.y,_vector.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Int8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int8BufferAttribute.prototype.constructor=Int8BufferAttribute,Uint8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8BufferAttribute.prototype.constructor=Uint8BufferAttribute,Uint8ClampedBufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8ClampedBufferAttribute.prototype.constructor=Uint8ClampedBufferAttribute,Int16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int16BufferAttribute.prototype.constructor=Int16BufferAttribute,Uint16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint16BufferAttribute.prototype.constructor=Uint16BufferAttribute,Int32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int32BufferAttribute.prototype.constructor=Int32BufferAttribute,Uint32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint32BufferAttribute.prototype.constructor=Uint32BufferAttribute,Float32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float32BufferAttribute.prototype.constructor=Float32BufferAttribute,Float64BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float64BufferAttribute.prototype.constructor=Float64BufferAttribute;var _bufferGeometryId=1,_box=new Box3;_vector=new Vector3;function BufferGeometry(){Object.defineProperty(this,"id",{value:_bufferGeometryId+=2}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function getExtrudeGeometry(t,e,n){const{position:r,normal:i,uv:o,indices:s}=getExtrudeGeometryParams(t,e,n),a=new Float32Array(r.length);a.fill(1,0,r.length);const u=new BufferGeometry;return u.setAttribute("color",new BufferAttribute(a,3)),u.setAttribute("normal",new BufferAttribute(i,3)),u.setAttribute("position",new BufferAttribute(r,3)),u.setAttribute("uv",new BufferAttribute(o,2)),u.setIndex(new Uint32BufferAttribute(s,1)),u}function getExtrudeGeometryParams(t,e,n,{needsOutline:r,top:i,bottom:o,side:s}){const a=getPolygonPositions(t,n);if(!a)return null;const{position:u,normal:l,uv:h,indices:c}=extrudePolygon(a,{depth:e});if(r){const{outline:t}=getOutlineFromExtrudePolygon(a,{depth:e,top:void 0===i||i,bottom:void 0!==o&&o,side:void 0===s||s});return{position:u,normal:l,uv:h,indices:c,outline:t}}return{position:u,normal:l,uv:h,indices:c}}function initVertexColors(t,e,n){const r=t.attributes.position.array,i=r.length,o=e instanceof Color?e:new Color(e),s=[];for(let t=0;t<i;t+=3){r[t+2]>0?s.push(n.r,n.r,n.b):s.push(o.r,o.r,o.b)}return t.setAttribute("color",new Float32BufferAttribute(s,3,!0)),s}function changeUVAndVertecColors(t,e){const n=t.getAttribute("color"),r=t.getAttribute("position"),i=t.getIndex();for(let t=0,o=i.length;t<o;){const o=i[t],s=i[t+1],a=i[t+2],u=r[3*o+2],l=r[3*s+2],h=r[3*a+2];u>0&&l>0&&h>0&&(n[3*o]=e.r,n[3*o+1]=e.g,n[3*o+2]=e.b,n[3*s]=e.r,n[3*s+1]=e.g,n[3*s+2]=e.b,n[3*a]=e.r,n[3*a+1]=e.g,n[3*a+2]=e.b),t+=3}return t}function getCenterOfPoints(t=[]){let e=1/0,n=1/0,r=-1/0,i=-1/0;for(let o=0,s=t.length;o<s;o++){const s=t[o];let a,u;Array.isArray(s)?(a=s[0],u=s[1]):(a=s.x,u=s.y),e=Math.min(e,a),n=Math.min(n,u),r=Math.max(r,a),i=Math.max(i,u)}return{x:(e+r)/2,y:(n+i)/2}}function getPolygonPositions(t,e,n=!1){if(!t)return null;let r=[];if(isGeoJSONPolygon(t)){const i=getGeoJSONCenter(t);if(isGeoJSONMulti(t)){const o=spliteGeoJSONMulti(t);for(let t=0,s=o.length;t<s;t++)r.push(getSinglePolygonPositions(o[t],e||i,n))}else{const o=getSinglePolygonPositions(t,e||i,n);r.push(o)}}return r}function getSinglePolygonPositions(t,e,n=!1){let r,i;if(isGeoJSONPolygon(t)){const n=getGeoJSONCoordinates(t);r=n[0],i=n.slice(1,n.length),e=e||getGeoJSONCenter(t)}const o=e;let s;s=n?new Float32Array(2*r.length):[];for(let t=0,e=r.length;t<e;t++){const e=r[t],i={x:e[0]-o.x,y:e[1]-o.y};if(n){const e=2*t;s[e]=i.x,s[e+1]=i.y}else s.push([i.x,i.y])}const a=[n?s.buffer:s];if(i&&i.length>0)for(let t=0,e=i.length;t<e;t++){const e=n?new Float32Array(2*i[t].length):[];for(let r=0,s=i[t].length;r<s;r++){const s=i[t][r],a={x:s[0]-o.x,y:s[1]-o.y};if(n){const t=2*r;e[t]=a.x,e[t+1]=a.y}else e.push([a.x,a.y])}a.push(n?e.buffer:e)}return a}function getOutlineFromExtrudePolygon(t,e){const n=e.depth,r=e.translate||[0,0],i=e.scale||[1,1],o=e.top,s=e.bottom||!1,a=e.side,u=[];for(let e=0;e<t.length;e++){let l=removeClosePointsOfPolygon(t[e],.01);if(!l)continue;const{vertices:h,holes:c,dimensions:f}=earcut.flatten(l);for(let t=0;t<h.length;t+=2)h[t]=h[t]*i[0]+r[0],h[t+1]=h[t+1]*i[1]+r[1],a&&(u.push(h[t]+.01,h[t+1]+.01,0),u.push(h[t]+.01,h[t+1]+.01,n)),t<h.length-3&&(o&&(u.push(h[t]+.01,h[t+1]+.01,n),u.push(h[t+2]+.01,h[t+3]+.01,n)),s&&(u.push(h[t]+.01,h[t+1]+.01,0),u.push(h[t+2]+.01,h[t+3]+.01,0)))}return{outline:new Float32Array(u)}}function mergeBufferGeometries(t,e){if(t.length<1)return null;const n={};for(let e=0;e<t.length;++e){const r=t[e];for(let t in r)void 0===n[t]&&(n[t]=[]),n[t].push(r[t])}const r={};let i=0;const o=[];for(let t in n)if("indices"===t){const e=n[t];for(let t=0,r=e.length;t<r;t++){const r=e[t];for(let t=0,e=r.length;t<e;t++)o.push(r[t]+i);i+=n.position[t].length/3}}else{const e=mergeBufferAttributes(n[t]);if(!e)return null;r[t]=e}r.indices=new Uint32Array(o);const{position:s,normal:a,uv:u,indices:l}=r,h=new BufferGeometry,c=new Float32Array(s.length);return c.fill(1,0,s.length),h.setAttribute("color",new BufferAttribute(c,3)),h.setAttribute("normal",new BufferAttribute(a,3)),h.setAttribute("position",new BufferAttribute(s,3)),u&&u.length&&h.setAttribute("uv",new BufferAttribute(u,2)),e&&(h.deleteAttribute("normal"),h.setAttribute("instanceStart",new BufferAttribute(r.instanceStart,3)),h.setAttribute("instanceEnd",new BufferAttribute(r.instanceEnd,3))),h.setIndex(new BufferAttribute(l,1)),h}function mergeBufferAttributes(t){let e=0;for(let n=0;n<t.length;++n){e+=t[n].length}const n=new Float32Array(e);let r=0;for(let e=0;e<t.length;++e)n.set(t[e],r),r+=t[e].length;return n}function removeDupEndPts(t){var e=t.length;t[0]instanceof Vector3?e>2&&t[e-1].equals(t[0])&&t.pop():e>2&&.01<Math.abs(t[e-1],t[0])&&t.pop()}function getSegmentsPositions(t,e,n){const r=t.geometry.coordinates,i=[],o=new Vector3(1/0,1/0,1/0),s=new Vector3(-1/0,-1/0,-1/0);let a=n?t.properties[n]:.01;if(n&&a<100)return!1;n&&(a*=2);for(let t=0;t<r.length;t++)t<1||t>r.length-2?i.push(r[t][0]-e.x,r[t][1]-e.y,r[t][2]?r[t][2]:a):(i.push(r[t][0]-e.x,r[t][1]-e.y,r[t][2]?r[t][2]:a),i.push(r[t][0]-e.x,r[t][1]-e.y,r[t][2]?r[t][2]:a)),r[t][0]>s.x&&(s.x=r[t][0]),r[t][1]>s.y&&(s.y=r[t][1]),r[t][2]&&r[t][2]>s.z?s.z=r[t][2]:r[t][2]||(s.z=1),r[t][0]<o.x&&(o.x=r[t][0]),r[t][1]<o.y&&(o.y=r[t][1]),r[t][2]&&r[t][2]<o.z?o.z=r[t][2]:r[t][2]||(o.z=a);return{position:new Float32Array(i),min:o,max:s}}function getPolygonParams(t,e){if(t&&t.geometry){const n=earcut.flatten(t.geometry.coordinates),r=n.dimensions,i=[],o=[],s=n.holes,a=[],u=[],l=getBoundingBox(t.geometry.coordinates),h=l.min.x-e.x,c=l.min.y-e.y,f=l.max.x-e.x,d=l.max.y-e.y;for(let s=0;s<n.vertices.length;){const l=n.vertices[s+0]-e.x,p=n.vertices[s+1]-e.y;if(i.push(l,p,r>2?n.vertices[s+2]:.01),o.push(l,p),s<t.geometry.coordinates[0].length*r){const t=(l-h)/(f-h),e=(p-c)/(d-c);a.push(t,e)}else a.push(0,0);u.push(0,0,1),s+=r}return{position:i,normal:u,uv:a,indices:earcut(o,s,2),min:l.min,max:l.max}}}function getBoundingBox(t){const e=new Vector3(1/0,1/0,1/0),n=new Vector3(-1/0,-1/0,-1/0);if(t&&t.length){const r=t[0];for(let t=0;t<r.length;t++)e.x>r[t][0]&&(e.x=r[t][0]),e.y>r[t][1]&&(e.y=r[t][1]),r[t][2]&&e.z>r[t][2]&&(e.z=r[t][2]),n.x<r[t][0]&&(n.x=r[t][0]),n.y<r[t][1]&&(n.y=r[t][1]),r[t][2]&&n.z<r[t][2]&&(n.z=r[t][2]);r[0][2]||(e.z=-1,n.z=1)}return new Box3(e,n)}function organizedBuilding(t){const e=[],n=[],r=[],i=[];for(let e=0;e<t.length;e++){const n=t[e];i.push(isGeoJSONPolygon(n)?getGeoJSONCenter(n):n.boundingBox.getCenter())}const o=getCenterOfPoints(i);let s=0,a=0,u=0;for(let i=0;i<t.length;i++){const l=t[i],h=isGeoJSONPolygon(l)?l.properties.height:1;if(h&&h>999)continue;const c=getExtrudeGeometryParams(l,h,o,{needsOutline:!0,top:!0,bottom:!1,side:!0});n.push({position:c.outline}),delete c.outline,e.push(c);const{position:f,normal:d,uv:p,indices:y}=c,g=f.length/3,m=d.length/3,x=p.length/2;r[i]={position:{count:g,start:s,end:s+3*g},normal:{count:m,start:a,end:a+3*m},uv:{count:x,start:u,end:u+2*x},hide:!1},s+=3*g,a+=3*m,u+=2*x}return{geometry:mergeBufferGeometries(e),center:o,lineGeometry:mergeBufferGeometries(n)}}function organizedPolygon(t){const e=[],n=[],r=[];for(let e=t.length;e>0;e--){const n=t[e-1];if(r.push(isGeoJSONPolygon(n)?getGeoJSONCenter(n):n.boundingBox.getCenter()),isGeoJSONMulti(n)){const r=spliteGeoJSONMulti(n);t.splice(e-1,1),t.push(...r)}}const i=getCenterOfPoints(r);let o,s=0,a=0,u=0;for(let r=0;r<t.length;r++){let l=t[r];if(isGeoJSONMulti(t[r]))continue;const h=getPolygonParams(l,i);e.push(h),o?o.union(new Box3(h.min,h.max)):o=new Box3(h.min,h.max);const{position:c,normal:f,uv:d,indices:p}=h,y=c.length/3,g=f.length/3,m=d.length/2;n[r]={position:{count:y,start:s,end:s+3*y},normal:{count:g,start:a,end:a+3*g},uv:{count:m,start:u,end:u+2*m},hide:!1},s+=3*y,a+=3*g,u+=2*m}return{geometry:mergeBufferGeometries(e),boundingBox:o,center:i}}function organizedPolyline(t,e){const n=[],r=[];for(let e=0;e<t.length;e++){const n=t[e];if(r.push(isGeoJSONLine(n)?getGeoJSONCenter(n):n.boundingBox.getCenter()),isGeoJSONMulti(n)){const r=spliteGeoJSONMulti(n);t.splice(e,1),t.push(...r)}}const i=getCenterOfPoints(r);let o;for(let r=0;r<t.length;r++){if(isGeoJSONMulti(t[r]))continue;const s=getSegmentsPositions(t[r],i,e);o?o.union(new Box3(s.min,s.max)):o=new Box3(s.min,s.max),s&&n.push({position:s.position})}return{geometry:mergeBufferGeometries(n),center:i,boundingBox:o}}function organizedPoint(t){const e=[],n=[];for(let e=0;e<len;e++){const r=t[e];n.push(isGeoJSONPoint(polyline)?getGeoJSONCenter(r):r.geometry.coordinates)}const r=getCenterOfPoints(n);let i;for(let n=0;n<t.length;n++){if(isGeoJSONMulti(t[n]))continue;const o=computePosByOffset(t[n].geometry.coordinates,r);e.push(o[0],o[1],o[2]),i?i.expandByPoint((new Vector3).fromArray(o)):i=new Box3((new Vector3).fromArray(o),(new Vector3).fromArray(o))}const o=new BufferGeometry;return o.setAttribute("position",new BufferAttribute(new Float32Array(e),3)),{geometry:o,center:r,boundingBox:i}}function computePosByOffset(t,e){return t.length<2||e.length<2?(console.error("坐标数组数据不正确"),null):(t[0]=t[0]-e[0],t[1]=t[1]-e[1],t.length>2&&e.length>2&&(t[2]=t[2]-e[2]),t[2]=t[2]||.01,t)}function main(t){const e=t.data,n=e.encryption,tt=e.headers;if(e.url){const t=[];load(e.url,{onLoad:function(e){n&&(e=decode(new Pbf(e)));const r={crosswalk:null,road:null,arrow:null,linkTownshipRoad:null,linkHightway:null,linkExpressway:null,linkNPRoad:null,linkCountyRoad:null,linkOther:null,laneSolidWhite:null,laneDottedWhite:null,laneDottedYellow:null,laneSolidYellow:null,roadEdge:null,stopLine:null,building:null,mountain:null,river:null,grass:null};if(e&&e.features&&e.features.length){const n=splitFeatures(e.features);if(n.crosswalk.length){r.crosswalk=organizedPolygon(n.crosswalk);const e=countGeometry(n.crosswalk);r.crosswalk.count=e,removeAttributeNotNeed(r.crosswalk.geometry,["position","normal"]),t.push(r.crosswalk.geometry.attributes.position),t.push(r.crosswalk.geometry.attributes.indices),t.push(r.crosswalk.geometry.attributes.normal)}if(n.road.length){r.road=organizedPolygon(n.road);const e=countGeometry(n.road);r.road.count=e,removeAttributeNotNeed(r.road.geometry,["position","normal","uv"]),t.push(r.road.geometry.attributes.position),t.push(r.road.geometry.attributes.indices),t.push(r.road.geometry.attributes.normal)}if(n.arrow.length){r.arrow=organizedPolygon(pointToPolygon(n.arrow));const e=countGeometry(n.arrow);r.arrow.count=e,removeAttributeNotNeed(r.arrow.geometry,["position","normal"]),t.push(r.arrow.geometry.attributes.position),t.push(r.arrow.geometry.attributes.indices),t.push(r.arrow.geometry.attributes.normal)}if(n.laneSolidWhite.length){r.laneSolidWhite=organizedPolyline(n.laneSolidWhite);const e=countGeometry(n.laneSolidWhite);r.laneSolidWhite.count=e,removeAttributeNotNeed(r.laneSolidWhite.geometry),t.push(r.laneSolidWhite.geometry.attributes.position)}if(n.laneDottedWhite.length){r.laneDottedWhite=organizedPolyline(n.laneDottedWhite);const e=countGeometry(n.laneDottedWhite);r.laneDottedWhite.count=e,removeAttributeNotNeed(r.laneDottedWhite.geometry),t.push(r.laneDottedWhite.geometry.attributes.position)}if(n.laneDottedYellow.length){r.laneDottedYellow=organizedPolyline(n.laneDottedYellow);const e=countGeometry(n.laneDottedYellow);r.laneDottedYellow.count=e,removeAttributeNotNeed(r.laneDottedYellow.geometry),t.push(r.laneDottedYellow.geometry.attributes.position)}if(n.laneSolidYellow.length){r.laneSolidYellow=organizedPolyline(n.laneSolidYellow);const e=countGeometry(n.laneSolidYellow);r.laneSolidYellow.count=e,removeAttributeNotNeed(r.laneSolidYellow.geometry),t.push(r.laneSolidYellow.geometry.attributes.position)}if(n.roadEdge.length){r.roadEdge=organizedPolyline(n.roadEdge);const e=countGeometry(n.roadEdge);r.roadEdge.count=e,removeAttributeNotNeed(r.roadEdge.geometry),t.push(r.roadEdge.geometry.attributes.position)}if(n.stopLine.length){r.stopLine=organizedPolyline(n.stopLine);const e=countGeometry(n.stopLine);r.stopLine.count=e,removeAttributeNotNeed(r.stopLine.geometry),t.push(r.stopLine.geometry.attributes.position)}if(n.mountain.length){r.mountain=organizedPolyline(n.mountain,"ELEV");const e=countGeometry(n.mountain);r.mountain.count=e,r.mountain.geometry&&(removeAttributeNotNeed(r.mountain.geometry),t.push(r.mountain.geometry.attributes.position))}if(n.river.length){r.river=organizedPolygon(n.river);const e=countGeometry(n.river);r.river.count=e,removeAttributeNotNeed(r.river.geometry,["position","uv"]),t.push(r.river.geometry.attributes.position),t.push(r.river.geometry.attributes.indices),t.push(r.river.geometry.attributes.uv)}if(n.grass.length){r.grass=organizedPolygon(n.grass);const e=countGeometry(n.grass);r.grass.count=e,removeAttributeNotNeed(r.grass.geometry,["position","normal","uv"]),t.push(r.grass.geometry.attributes.position),t.push(r.grass.geometry.attributes.indices),t.push(r.grass.geometry.attributes.normal)}if(n.linkTownshipRoad.length){r.linkTownshipRoad=organizedPolyline(n.linkTownshipRoad);const e=countGeometry(n.linkTownshipRoad);r.linkTownshipRoad.count=e,r.linkTownshipRoad.geometry&&(removeAttributeNotNeed(r.linkTownshipRoad.geometry),t.push(r.linkTownshipRoad.geometry.attributes.position))}if(n.linkHightway.length){r.linkHightway=organizedPolyline(n.linkHightway);const e=countGeometry(n.linkHightway);r.linkHightway.count=e,r.linkHightway.geometry&&(removeAttributeNotNeed(r.linkHightway.geometry),t.push(r.linkHightway.geometry.attributes.position))}if(n.linkExpressway.length){r.linkExpressway=organizedPolyline(n.linkExpressway);const e=countGeometry(n.linkExpressway);r.linkExpressway.count=e,r.linkExpressway.geometry&&(removeAttributeNotNeed(r.linkExpressway.geometry),t.push(r.linkExpressway.geometry.attributes.position))}if(n.linkNPRoad.length){r.linkNPRoad=organizedPolyline(n.linkNPRoad);const e=countGeometry(n.linkNPRoad);r.linkNPRoad.count=e,r.linkNPRoad.geometry&&(removeAttributeNotNeed(r.linkNPRoad.geometry),t.push(r.linkNPRoad.geometry.attributes.position))}if(n.linkCountyRoad.length){r.linkCountyRoad=organizedPolyline(n.linkCountyRoad);const e=countGeometry(n.linkCountyRoad);r.linkCountyRoad.count=e,r.linkCountyRoad.geometry&&(removeAttributeNotNeed(r.linkCountyRoad.geometry),t.push(r.linkCountyRoad.geometry.attributes.position))}if(n.linkOther.length){r.linkOther=organizedPolyline(n.linkOther);const e=countGeometry(n.linkOther);r.linkOther.count=e,r.linkOther.geometry&&(removeAttributeNotNeed(r.linkOther.geometry),t.push(r.linkOther.geometry.attributes.position))}if(n.building.length){r.building=organizedBuilding(n.building);const e=countGeometry(n.building);r.building.count=e,removeAttributeNotNeed(r.building.geometry,["position","uv","normal","color"]),removeAttributeNotNeed(r.building.lineGeometry),t.push(r.building.geometry.attributes.position),t.push(r.building.geometry.attributes.uv),t.push(r.building.geometry.attributes.normal),t.push(r.building.geometry.attributes.color),t.push(r.building.geometry.attributes.indices),t.push(r.building.lineGeometry.attributes.position)}}postMessage(r,t)},onError:function(t){console.warn(t),postMessage({},[])},responseType:n?"arraybuffer":"json",requestHeader:{"Content-Type":"application/json",...tt}})}}function splitFeatures(t){const e={crosswalk:[],road:[],arrow:[],linkTownshipRoad:[],linkHightway:[],linkExpressway:[],linkNPRoad:[],linkCountyRoad:[],linkOther:[],laneSolidWhite:[],laneDottedWhite:[],laneDottedYellow:[],laneSolidYellow:[],roadEdge:[],stopLine:[],building:[],mountain:[],river:[],grass:[]};for(let n=0;n<t.length;n++){const r=t[n];if(isGeoJSONMulti(r[n]))console.log("几何类型错误");else if(r&&r.properties&&r.properties.property){const t=r.properties.property.toLowerCase();switch(t){case"crosswalk":e.crosswalk.push(r);break;case"road":e.road.push(r);break;case"arrow":e.arrow.push(r);break;case"lane_solid_white":e.laneSolidWhite.push(r);break;case"lane_dotted_white":e.laneDottedWhite.push(r);break;case"lane_dotted_yellow":e.laneDottedYellow.push(r);break;case"lane_solid_yellow":e.laneSolidYellow.push(r);break;case"road_edge":e.roadEdge.push(r);break;case"stop_line":e.stopLine.push(r);break;case"building":e.building.push(r);break;case"mountain":e.mountain.push(r);break;case"river":case"water":e.river.push(r);break;case"grass":e.grass.push(r);break;case"link_township_road":e.linkTownshipRoad.push(r);break;case"link_highway":e.linkHightway.push(r);break;case"link_expressway":e.linkExpressway.push(r);break;case"link_n_p_road":e.linkNPRoad.push(r);break;case"link_county_road":e.linkCountyRoad.push(r);break;default:t.indexOf("link")>-1&&e.linkOther.push(r)}}}return e}function countGeometry(t){if(t&&t.length>0){let e=0;return t.forEach(t=>{e+=t.geometry.coordinates.length}),e}return 0}function removeAttributeNotNeed(t,e){if(e||(e=["position"]),!t)return;const n=t.attributes;for(let r in n)e.indexOf(r)<0&&t.deleteAttribute(r);for(let e in n)t.attributes[e]=t.getAttribute(e).array.buffer;const r=t.getIndex();r&&r.count&&(t.attributes.indices=r.array.buffer)}Object.assign(BufferGeometry.prototype,{constructor:BufferGeometry,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(arrayMax(t)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Box3);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];_box.setFromBufferAttribute(i),this.morphTargetsRelative?(_vector.addVectors(this.boundingBox.min,_box.min),this.boundingBox.expandByPoint(_vector),_vector.addVectors(this.boundingBox.max,_box.max),this.boundingBox.expandByPoint(_vector)):(this.boundingBox.expandByPoint(_box.min),this.boundingBox.expandByPoint(_box.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new BufferAttribute(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var s,a,u,l=e.normal.array,h=new Vector3,c=new Vector3,f=new Vector3,d=new Vector3,p=new Vector3;if(t){var y=t.array;for(i=0,o=t.count;i<o;i+=3)s=3*y[i+0],a=3*y[i+1],u=3*y[i+2],h.fromArray(n,s),c.fromArray(n,a),f.fromArray(n,u),d.subVectors(f,c),p.subVectors(h,c),d.cross(p),l[s]+=d.x,l[s+1]+=d.y,l[s+2]+=d.z,l[a]+=d.x,l[a+1]+=d.y,l[a+2]+=d.z,l[u]+=d.x,l[u+1]+=d.y,l[u+2]+=d.z}else for(i=0,o=n.length;i<o;i+=9)h.fromArray(n,i),c.fromArray(n,i+3),f.fromArray(n,i+6),d.subVectors(f,c),p.subVectors(h,c),d.cross(p),l[i]=d.x,l[i+1]=d.y,l[i+2]=d.z,l[i+3]=d.x,l[i+4]=d.y,l[i+5]=d.z,l[i+6]=d.x,l[i+7]=d.y,l[i+8]=d.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],s=o.array,a=o.itemSize*e,u=Math.min(s.length,i.length-a),l=0,h=a;l<u;l++,h++)i[h]=s[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var s=o[e];this.setAttribute(e,s.clone())}var a=t.morphAttributes;for(e in a){var u=[],l=a[e];for(n=0,r=l.length;n<r;n++)u.push(l[n].clone());this.morphAttributes[e]=u}this.morphTargetsRelative=t.morphTargetsRelative;var h=t.groups;for(n=0,r=h.length;n<r;n++){var c=h[n];this.addGroup(c.start,c.count,c.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var d=t.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),onmessage=main;